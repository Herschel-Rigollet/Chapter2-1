{
  "openapi": "3.0.1",
  "info": {
    "title": "E-Commerce API",
    "description": "E-commerce backend API 문서입니다.",
    "version": "v1.0"
  },
  "servers": [
    {
      "url": "http://localhost:8080",
      "description": "Generated server url"
    }
  ],
  "tags": [
    {
      "name": "Order API",
      "description": "주문 및 결제 API"
    },
    {
      "name": "Popular Product API",
      "description": "인기 판매 상품 조회 API"
    },
    {
      "name": "Coupon API",
      "description": "선착순 쿠폰 발급 및 보유 쿠폰 조회 API"
    },
    {
      "name": "Product API",
      "description": "상품 조회 API"
    },
    {
      "name": "Balance API",
      "description": "잔액 충전 및 조회 API"
    }
  ],
  "paths": {
    "/orders": {
      "post": {
        "tags": [
          "Order API"
        ],
        "summary": "주문 및 결제",
        "description": "상품 ID 및 수량 목록을 기반으로 주문 및 결제를 수행합니다.",
        "operationId": "order",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/OrderRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/OrderResponse"
                }
              }
            }
          }
        }
      }
    },
    "/coupons/issue/{userId}": {
      "post": {
        "tags": [
          "Coupon API"
        ],
        "summary": "쿠폰 발급",
        "description": "선착순으로 사용자에게 쿠폰을 발급합니다.",
        "operationId": "issueCoupon",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/CouponResponse"
                }
              }
            }
          }
        }
      }
    },
    "/balance/charge": {
      "post": {
        "tags": [
          "Balance API"
        ],
        "summary": "잔액 충전",
        "description": "사용자 식별자와 금액을 입력받아 잔액을 충전합니다.",
        "operationId": "charge",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BalanceRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "충전 성공",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/BalanceResponse"
                }
              }
            }
          }
        }
      }
    },
    "/products": {
      "get": {
        "tags": [
          "Product API"
        ],
        "summary": "상품 전체 조회",
        "description": "모든 상품의 ID, 이름, 가격, 재고를 조회합니다.",
        "operationId": "getProducts",
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/ProductResponse"
                }
              }
            }
          }
        }
      }
    },
    "/popular-products": {
      "get": {
        "tags": [
          "Popular Product API"
        ],
        "summary": "인기 상품 조회",
        "description": "최근 3일간 가장 많이 팔린 상위 5개 상품을 조회합니다.",
        "operationId": "getPopularProducts",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ProductResponse"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/coupons/{userId}": {
      "get": {
        "tags": [
          "Coupon API"
        ],
        "summary": "보유 쿠폰 목록 조회",
        "description": "사용자가 보유한 쿠폰 목록을 반환합니다.",
        "operationId": "getUserCoupons",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CouponResponse"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/balance/{userId}": {
      "get": {
        "tags": [
          "Balance API"
        ],
        "summary": "잔액 조회",
        "description": "사용자의 현재 잔액을 조회합니다.",
        "operationId": "getBalance",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "조회 성공",
            "content": {
              "*/*": {
                "schema": {
                  "$ref": "#/components/schemas/BalanceResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "OrderItemDto": {
        "type": "object",
        "properties": {
          "productId": {
            "type": "integer",
            "description": "상품 ID",
            "format": "int64",
            "example": 1001
          },
          "quantity": {
            "type": "integer",
            "description": "수량",
            "format": "int32",
            "example": 2
          }
        },
        "description": "주문 상품 목록"
      },
      "OrderRequest": {
        "type": "object",
        "properties": {
          "userId": {
            "type": "integer",
            "description": "사용자 ID",
            "format": "int64",
            "example": 1
          },
          "couponId": {
            "type": "integer",
            "description": "사용할 쿠폰 ID (없으면 null)",
            "format": "int64",
            "example": 123
          },
          "items": {
            "type": "array",
            "description": "주문 상품 목록",
            "items": {
              "$ref": "#/components/schemas/OrderItemDto"
            }
          }
        }
      },
      "OrderResponse": {
        "type": "object",
        "properties": {
          "orderId": {
            "type": "integer",
            "description": "주문 ID",
            "format": "int64",
            "example": 501
          },
          "userId": {
            "type": "integer",
            "description": "사용자 ID",
            "format": "int64",
            "example": 1
          },
          "totalPrice": {
            "type": "integer",
            "description": "총 결제 금액",
            "format": "int64",
            "example": 18000
          },
          "createdAt": {
            "type": "string",
            "description": "주문 시간",
            "format": "date-time"
          },
          "items": {
            "type": "array",
            "description": "주문 상품 목록",
            "items": {
              "$ref": "#/components/schemas/OrderItemDto"
            }
          }
        }
      },
      "CouponResponse": {
        "type": "object",
        "properties": {
          "couponId": {
            "type": "integer",
            "description": "쿠폰 ID",
            "format": "int64",
            "example": 101
          },
          "userId": {
            "type": "integer",
            "description": "사용자 ID",
            "format": "int64",
            "example": 1
          },
          "discountRate": {
            "type": "number",
            "description": "할인율 (%)",
            "format": "double",
            "example": 10
          },
          "used": {
            "type": "boolean",
            "description": "사용 여부",
            "example": false
          },
          "issuedAt": {
            "type": "string",
            "description": "쿠폰 발급 일시",
            "format": "date-time"
          },
          "expiresAt": {
            "type": "string",
            "description": "쿠폰 만료 일시",
            "format": "date-time"
          }
        },
        "description": "쿠폰 응답 DTO"
      },
      "BalanceRequest": {
        "type": "object",
        "properties": {
          "userId": {
            "type": "integer",
            "description": "사용자 ID",
            "format": "int64",
            "example": 1
          },
          "amount": {
            "type": "integer",
            "description": "충전 금액",
            "format": "int64",
            "example": 5000
          }
        },
        "description": "잔액 충전 요청 DTO"
      },
      "BalanceResponse": {
        "type": "object",
        "properties": {
          "userId": {
            "type": "integer",
            "description": "사용자 ID",
            "format": "int64"
          },
          "balance": {
            "type": "integer",
            "description": "현재 잔액",
            "format": "int64"
          }
        },
        "description": "잔액 응답 DTO"
      },
      "ProductResponse": {
        "type": "object",
        "properties": {
          "productId": {
            "type": "integer",
            "format": "int64"
          },
          "productName": {
            "type": "string"
          },
          "price": {
            "type": "integer",
            "format": "int64"
          },
          "stock": {
            "type": "integer",
            "format": "int32"
          }
        }
      }
    }
  }
}